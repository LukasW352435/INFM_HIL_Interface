<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>INFM HIL Interface: CAN Connector</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">INFM HIL Interface
   </div>
   <div id="projectbrief">Interface between Artery simulation and DuTs</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">CAN Connector </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >The CAN Connector enables the communication between the simulation and a device under test (DuT) over CAN/CANFD. It supports one-time sending of frames as well as a cyclic sending of frames. It can be configured which frames should be received on the CAN/CANFD interface and it can also filter for content changes in the frames.</p>
<p >The CAN Connector is not responsible for the configuration of the used CAN/CANFD interface (Bitrate, Sample point etc.) as this is dependent on the used hardware. The user must therefore ensure that the interface is configured correctly for the communication with the DuT.</p>
<p >The CAN Connector builds upon the Broadcast Manager (BCM) socket of the Linux Kernel Module SocketCAN and the Boost.Asio network library as well as the INFM_HIL_Interface.</p>
<h1><a class="anchor" id="autotoc_md13"></a>
Dependencies</h1>
<ul>
<li>SocketCAN</li>
<li>Boost.Asio</li>
</ul>
<h1><a class="anchor" id="autotoc_md14"></a>
Configuration</h1>
<p >The CAN Connector is configured through a XML configuration file which contains the following options. It is also recommended to the read the BCM socket documentation to fully understand the details of the options <a href="https://www.kernel.org/doc/Documentation/networking/can.txt">SocketCAN documentation</a>.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">interfaceName   </td><td class="markdownTableBodyNone">The name of the interface that should be used.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">operations   </td><td class="markdownTableBodyNone">See the <a class="el" href="md_Sim_To_DuT_Interface_DuT_Connectors_ReadMe.html">Base Connector documentation</a>.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">codecName   </td><td class="markdownTableBodyNone">The name of the codec that should be used by the connector. See the Codec section down below.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">frameToOperation   </td><td class="markdownTableBodyNone">The configurations for the receive operations defined in the XML.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">operationToFrame   </td><td class="markdownTableBodyNone">The configurations for the send operations defined in the XML.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">periodicOperations   </td><td class="markdownTableBodyNone">Since the CAN Connector is handling the cyclic sending of frames itself this should always be empty.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">periodicTimerEnabled   </td><td class="markdownTableBodyNone">Since the CAN Connector is handling the cyclic sending of frames itself this should always be false.   </td></tr>
</table>
<p >The structure of the CAN Connector Config is described here <a href="https://lukasw352435.github.io/INFM_HIL_Interface/classsim__interface_1_1dut__connector_1_1can_1_1CANConnectorConfig.html">CANConnectorConfig</a> The structure of a send operation is described here <a href="https://lukasw352435.github.io/INFM_HIL_Interface/classsim__interface_1_1dut__connector_1_1can_1_1CANConnectorSendOperation.html">CANConnectorSendOperation</a> The structure of a receive operation is described here <a href="https://lukasw352435.github.io/INFM_HIL_Interface/classsim__interface_1_1dut__connector_1_1can_1_1CANConnectorReceiveOperation.html">CANConnectorReceiveOperation</a> </p>
<h1><a class="anchor" id="autotoc_md15"></a>
Codec</h1>
<p >Since the translation of simulation messages (SimEvents) and CAN/CANFD frames is complex and is also dependend on the DuT, this cannot be practical specified in the XML configuration file. The user must therfore implement a concret Codec class that handles this translation task and add it as an option in the Codec factory.</p>
<p >The Codec interface is described here <a href="https://lukasw352435.github.io/INFM_HIL_Interface/classsim__interface_1_1dut__connector_1_1can_1_1CANConnectorCodec.html">CANConnectorCodec</a> The Codec factory is described here <a href="https://lukasw352435.github.io/INFM_HIL_Interface/classsim__interface_1_1dut__connector_1_1can_1_1CANConnectorCodecFactory.html">CANConnectorCodecFactory</a> </p>
<h1><a class="anchor" id="autotoc_md16"></a>
Testing</h1>
<p >To test the CAN Connector you can use a virtual CAN interface. Ensure that you have the needed SocketCAN Kernel modules.</p>
<div class="fragment"><div class="line">// Install the can-utils. </div>
<div class="line">sudo apt-get install can-utils</div>
<div class="line"> </div>
<div class="line">// Modprobe is needed in the case the vcan module is not loaded.</div>
<div class="line">modprobe vcan</div>
<div class="line"> </div>
<div class="line">// Create a virtual CAN interface.</div>
<div class="line">ip link add dev vcan0 type vcan</div>
<div class="line"> </div>
<div class="line">// Set the interface up and running.</div>
<div class="line">ip link set vcan0 up</div>
<div class="line"> </div>
<div class="line">// To see the CAN/CANFD messages that are send by the CAN Connector on </div>
<div class="line">// the virtual CAN interface open a terminal and use the candump tool.</div>
<div class="line">candump vcan0</div>
<div class="line"> </div>
<div class="line">// Compile and start the project</div>
<div class="line"> </div>
<div class="line">// If you want to send CAN/CANFD messages to the CAN Connector over the </div>
<div class="line">// virtual CAN interface open a terminal and use the cansend tool.</div>
<div class="line">cansend vcan0 123#DEADBEEF</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md17"></a>
Helpful links:</h1>
<ul>
<li><a href="https://lukasw352435.github.io/INFM_HIL_Interface/md_Sim_To_DuT_Interface_DuT_Connectors_ReadMe.html">Base Connector</a></li>
<li><a href="https://www.kernel.org/doc/Documentation/networking/can.txt">SocketCAN documentation</a></li>
<li><a href="https://www.boost.org/doc/libs/1_75_0/doc/html/boost_asio.html">Boost.Asio documentation</a></li>
<li><a href="https://github.com/linux-can/can-utils">SocketCAN userspace utilities and tools</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Dec 19 2021 12:36:16 for INFM HIL Interface by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
